# Gilbert-Elliot模型科学参数设置指南

## 概述

基于NTIA技术备忘录TM-23-565，本文档提供科学的GE模型参数设置，用于IPsec性能测试和性能拐点分析。

## 模型选择建议

### 1. 双参数模型 (推荐用于基础测试)
**适用场景**: 简单网络拥塞模拟
**参数**: 错误率(ε) + 预期突发长度(L₁)
**特点**: 简单易用，适合快速测试

### 2. 三参数模型 (推荐用于主要测试)
**适用场景**: 真实网络环境模拟
**参数**: 错误率(ε) + 预期突发长度(L₁) + 坏状态时间比例(πB)
**特点**: 平衡了真实性和复杂性

### 3. 四参数模型 (用于复杂环境)
**适用场景**: 复杂网络环境模拟
**参数**: 错误率(ε) + 预期突发长度(L₁) + 坏状态时间比例(πB) + 坏状态无错误概率(h)
**特点**: 最真实，但参数设置复杂

## 科学参数设置方案

### 方案A: 性能拐点发现 (推荐)

#### 1. 错误率范围设置
```bash
# 低错误率区域 (0-5%)
错误率: 0%, 1%, 2%, 3%, 4%, 5%

# 中等错误率区域 (5-15%) 
错误率: 5%, 7%, 10%, 12%, 15%

# 高错误率区域 (15-25%)
错误率: 15%, 18%, 20%, 22%, 25%
```

#### 2. 突发长度设置
```bash
# 短突发 (模拟轻微拥塞)
L₁ = 2-3

# 中等突发 (模拟一般网络问题)
L₁ = 5-8

# 长突发 (模拟严重网络问题)
L₁ = 10-15
```

#### 3. 坏状态时间比例设置
```bash
# 轻度网络问题
πB = 0.1-0.3

# 中度网络问题
πB = 0.3-0.6

# 重度网络问题
πB = 0.6-0.8
```

### 方案B: 详细性能分析

#### 1. 错误率精细扫描
```bash
# 0-10% 精细扫描 (每0.5%)
错误率: 0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0

# 10-20% 精细扫描 (每1%)
错误率: 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20
```

#### 2. 突发长度组合
```bash
# 固定突发长度测试
L₁ = 3, 5, 8, 12

# 可变突发长度 (根据错误率调整)
低错误率(0-5%): L₁ = 2-3
中错误率(5-15%): L₁ = 3-8  
高错误率(15-25%): L₁ = 5-12
```

## 具体测试配置

### 配置1: 基础性能测试 (双参数模型)
```bash
# 测试参数组合
错误率: 0%, 2%, 5%, 8%, 10%, 12%, 15%, 18%, 20%
突发长度: 3 (固定)

# 每个配置测试次数
测试次数: 50次/配置
```

### 配置2: 真实网络模拟 (三参数模型)
```bash
# 轻度网络问题
错误率: 1%, 3%, 5%
突发长度: 3
坏状态时间: 20%

# 中度网络问题  
错误率: 5%, 8%, 10%, 12%
突发长度: 5
坏状态时间: 40%

# 重度网络问题
错误率: 12%, 15%, 18%, 20%
突发长度: 8
坏状态时间: 60%
```

### 配置3: 性能拐点精确定位
```bash
# 拐点区域精细扫描
错误率: 8%, 8.5%, 9%, 9.5%, 10%, 10.5%, 11%, 11.5%, 12%
突发长度: 5
坏状态时间: 40%

# 每个配置测试次数
测试次数: 100次/配置
```

## 自动化测试脚本

### 创建GE模型测试脚本
```bash
#!/bin/bash
# ge_performance_test.sh

# 参数设置
LOSS_RATES="0 2 5 8 10 12 15 18 20"
BURST_LENGTHS="3 5 8"
BAD_STATE_TIMES="0.2 0.4 0.6"
TEST_COUNT=50

# 测试函数
test_ge_config() {
    local loss_rate=$1
    local burst_length=$2
    local bad_state_time=$3
    local output_file=$4
    
    echo "测试: 错误率=${loss_rate}%, 突发长度=${burst_length}, 坏状态时间=${bad_state_time}"
    
    # 设置网络条件
    sudo ./set_realistic_network.sh -l $loss_rate -m gilbert -b $burst_length -t $bad_state_time
    
    # 运行IPsec测试
    sudo ./connection_test.sh -l "$loss_rate" -n $TEST_COUNT -o "${output_file}_${loss_rate}_${burst_length}_${bad_state_time}.csv"
}
```

## 数据收集策略

### 1. 主要指标
- **HCT (Handshake Completion Time)**: IKEv2握手完成时间
- **成功率**: 连接建立成功率
- **重传次数**: 数据包重传统计
- **延迟分布**: 握手延迟的分布特征

### 2. 拐点识别指标
- **成功率拐点**: 成功率从>95%急剧下降到<80%的错误率点
- **HCT拐点**: HCT从线性增长变为指数增长的错误率点
- **重传拐点**: 重传次数从<5次急剧增加到>20次的错误率点

### 3. 数据格式
```csv
# 输出格式
错误率(%),突发长度,坏状态时间,测试序号,结果,HCT(ms),重传次数,成功率(%)
```

## 性能拐点分析方法

### 1. 拐点识别算法
```python
def find_performance_knee(data):
    """
    使用Kneedle算法识别性能拐点
    """
    # 计算成功率曲线
    success_rates = []
    loss_rates = []
    
    # 寻找拐点
    knee_point = kneedle_algorithm(loss_rates, success_rates)
    
    return knee_point
```

### 2. 多维度拐点分析
- **单维度**: 基于错误率的拐点
- **双维度**: 错误率+突发长度的拐点曲面
- **三维度**: 错误率+突发长度+坏状态时间的拐点空间

## 预期结果和图表

### 图4: 基础性能曲线
- X轴: 错误率 (0-25%)
- Y轴: HCT (ms)
- 多条曲线: 不同突发长度

### 图5: 成功率曲线
- X轴: 错误率 (0-25%)  
- Y轴: 成功率 (%)
- 拐点标记: 性能拐点位置

### 图6: 性能拐点热力图
- X轴: 错误率
- Y轴: 突发长度
- 颜色: 性能指标 (HCT/成功率)
- 等值线: 拐点边界

## 实施建议

### 1. 分阶段测试
1. **阶段1**: 基础双参数模型测试 (0-20%错误率)
2. **阶段2**: 三参数模型精细测试 (拐点区域)
3. **阶段3**: 四参数模型验证测试 (复杂环境)

### 2. 质量控制
- 每个配置至少50次测试
- 拐点区域至少100次测试
- 异常值检测和过滤
- 统计显著性检验

### 3. 结果验证
- 交叉验证不同模型参数
- 对比不同网络接口
- 验证拐点的稳定性
- 分析拐点的物理意义

## 脚本使用示例

```bash
# 基础性能测试
sudo ./ge_performance_test.sh --mode basic --loss-range "0 5 10 15 20" --burst-length 5

# 拐点精确定位
sudo ./ge_performance_test.sh --mode knee --loss-range "8 9 10 11 12" --burst-length 5 --test-count 100

# 完整性能分析
sudo ./ge_performance_test.sh --mode full --output ge_performance_results.csv
```

这个参数设置方案基于NTIA的科学研究，能够系统性地发现IPsec性能拐点，为网络优化提供科学依据。 