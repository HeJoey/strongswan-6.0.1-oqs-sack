# strongSwan çªå‘ä¸¢åŒ…ç‡æ€§èƒ½æµ‹è¯•å·¥å…·é›†

æœ¬å·¥å…·é›†ç”¨äºæµ‹è¯•strongSwan IPsecåœ¨ä¸åŒçªå‘ä¸¢åŒ…ç‡æ¡ä»¶ä¸‹çš„æ€§èƒ½è¡¨ç°ï¼Œä¸“é—¨ç”¨äºç”Ÿæˆè®ºæ–‡ä¸­çš„å›¾5å’Œå›¾6ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒè„šæœ¬

1. **`burst_loss_test.sh`** - ä¸»æµ‹è¯•è„šæœ¬
   - è‡ªåŠ¨æµ‹è¯•ä¸åŒçªå‘ä¸¢åŒ…ç‡ä¸‹çš„è¿æ¥æ€§èƒ½
   - æ”¶é›†è¿æ¥æˆåŠŸç‡ã€æ¡æ‰‹å®Œæˆæ—¶é—´(HCT)ã€é‡ä¼ æ¬¡æ•°ç­‰æ•°æ®
   - ç”Ÿæˆé€‚åˆç»˜å›¾çš„CSVæ•°æ®æ–‡ä»¶

2. **`set_network_conditions.sh`** - ç½‘ç»œæ¡ä»¶è®¾ç½®è„šæœ¬
   - å¿«é€Ÿè®¾ç½®æŒ‡å®šçš„ä¸¢åŒ…ç‡
   - æ”¯æŒçªå‘ä¸¢åŒ…å’Œéšæœºä¸¢åŒ…æ¨¡å¼
   - æä¾›ç½‘ç»œæ¡ä»¶æ¸…ç†å’ŒçŠ¶æ€æŸ¥çœ‹åŠŸèƒ½

3. **`retransmission_stats.sh`** - é‡ä¼ ç»Ÿè®¡ä¸“ç”¨è„šæœ¬
   - ä¸“é—¨ç»Ÿè®¡IKEæ¶ˆæ¯çš„é‡ä¼ æ¬¡æ•°å’Œæ¨¡å¼
   - æ”¯æŒå®æ—¶ç›‘æ§å’Œå†å²æ—¥å¿—åˆ†æ
   - ç”Ÿæˆè¯¦ç»†çš„é‡ä¼ ç»Ÿè®¡æŠ¥å‘Š

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®Œæ•´çªå‘ä¸¢åŒ…ç‡æµ‹è¯•

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°è¿è¡Œå®Œæ•´æµ‹è¯•
sudo ./burst_loss_test.sh

# è‡ªå®šä¹‰æµ‹è¯•æ¬¡æ•° (æ¯ä¸ªä¸¢åŒ…ç‡æµ‹è¯•50æ¬¡)
sudo ./burst_loss_test.sh -n 50

# æŒ‡å®šç½‘ç»œæ¥å£
sudo ./burst_loss_test.sh -i enp0s3
```

### 2. è®¾ç½®ç‰¹å®šç½‘ç»œæ¡ä»¶

```bash
# è®¾ç½®10%çªå‘ä¸¢åŒ…ç‡
sudo ./set_network_conditions.sh -b 10

# è®¾ç½®15%éšæœºä¸¢åŒ…ç‡
sudo ./set_network_conditions.sh 15

# æ¸…ç†ç½‘ç»œæ¡ä»¶è®¾ç½®
sudo ./set_network_conditions.sh -c

# æŸ¥çœ‹å½“å‰ç½‘ç»œæ¡ä»¶
sudo ./set_network_conditions.sh -s
```

### 3. é‡ä¼ æ•°æ®ç»Ÿè®¡

```bash
# æ‰§è¡Œé‡ä¼ ç»Ÿè®¡æµ‹è¯•
sudo ./retransmission_stats.sh

# å®æ—¶ç›‘æ§é‡ä¼ æ´»åŠ¨
sudo ./retransmission_stats.sh -l

# åˆ†æç°æœ‰æ—¥å¿—
sudo ./retransmission_stats.sh -r
```

## ğŸ“Š ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶

### ä¸»è¦è¾“å‡ºæ–‡ä»¶

1. **`burst_loss_results_TIMESTAMP/`** - ä¸»æµ‹è¯•ç»“æœç›®å½•
   - `burst_loss_results.csv` - åŸå§‹æµ‹è¯•æ•°æ®
   - `summary_statistics.csv` - æ±‡æ€»ç»Ÿè®¡æ•°æ® (ç”¨äºå›¾5)
   - `hct_boxplot_data.csv` - ç®±å½¢å›¾æ•°æ® (ç”¨äºå›¾6)
   - `statistics_X%_txt` - å„ä¸¢åŒ…ç‡çš„è¯¦ç»†ç»Ÿè®¡

2. **é‡ä¼ ç»Ÿè®¡æ–‡ä»¶**
   - `retransmission_stats_TIMESTAMP.csv` - é‡ä¼ æ•°æ®
   - `retransmission_stats_TIMESTAMP_report.txt` - é‡ä¼ æŠ¥å‘Š

### æ•°æ®æ ¼å¼è¯´æ˜

#### summary_statistics.csv (å›¾è¡¨æ•°æ®)
```csv
# ä¸¢åŒ…ç‡(%),æˆåŠŸç‡(%),HCTå‡å€¼(s),HCTä¸­ä½æ•°(s),HCTæ ‡å‡†å·®(s),å¹³å‡é‡ä¼ æ¬¡æ•°
0,100.00,2.456,2.234,0.345,0.00
5,96.67,3.123,2.876,0.567,1.23
10,90.00,4.234,3.456,0.789,2.45
...
```

#### hct_boxplot_data.csv (ç®±å½¢å›¾æ•°æ®)
```csv
# ä¸¢åŒ…ç‡(%),HCT(s)
0,2.234
0,2.456
0,2.123
5,2.876
5,3.234
...
```

## ğŸ“ˆ æ•°æ®å¯è§†åŒ–å»ºè®®

### å›¾5: è¿æ¥æˆåŠŸç‡ vs çªå‘ä¸¢åŒ…ç‡
**æ¨èæ ·å¼**: å¸¦æ ‡è®°çš„æ›²çº¿å›¾
- Xè½´: çªå‘ä¸¢åŒ…ç‡ (%)
- Yè½´: è¿æ¥æˆåŠŸç‡ (%)
- æ•°æ®æº: `summary_statistics.csv` ç¬¬1,2åˆ—

### å›¾6: æ¡æ‰‹å®Œæˆæ—¶é—´(HCT) vs çªå‘ä¸¢åŒ…ç‡
**æ¨èæ ·å¼**: ç®±å½¢å›¾ (Box Plot)
- Xè½´: çªå‘ä¸¢åŒ…ç‡ (%)
- Yè½´: HCT (ç§’)
- æ•°æ®æº: `hct_boxplot_data.csv`

### å›¾7: IKEæ¶ˆæ¯å¹³å‡é‡ä¼ æ¬¡æ•° vs çªå‘ä¸¢åŒ…ç‡
**æ¨èæ ·å¼**: å¸¦è¯¯å·®æ£’çš„æ›²çº¿å›¾
- Xè½´: çªå‘ä¸¢åŒ…ç‡ (%)
- Yè½´: å¹³å‡é‡ä¼ æ¬¡æ•°
- æ•°æ®æº: `summary_statistics.csv` ç¬¬1,6åˆ—

## âš™ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰ä¸¢åŒ…ç‡èŒƒå›´

ç¼–è¾‘ `burst_loss_test.sh` ä¸­çš„ `LOSS_RATES` æ•°ç»„:
```bash
readonly LOSS_RATES=(0 2 5 8 10 15 20 25 30 35 40 45 50)
```

### çªå‘æ¨¡å¼é…ç½®

åœ¨ `burst_loss_test.sh` ä¸­ä¿®æ”¹çªå‘å¤§å°:
```bash
readonly BURST_SIZE=3  # è¿ç»­ä¸¢åŒ…æ•°é‡
```

### æµ‹è¯•å‚æ•°è°ƒæ•´

```bash
# ä¿®æ”¹é»˜è®¤æµ‹è¯•æ¬¡æ•°
readonly DEFAULT_TESTS_PER_LOSS_RATE=30

# ä¿®æ”¹è¿æ¥è¶…æ—¶æ—¶é—´
readonly DEFAULT_CONNECTION_TIMEOUT=60
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿ä»¥rootæƒé™è¿è¡Œ
   sudo ./burst_loss_test.sh
   ```

2. **ç½‘ç»œæ¥å£ä¸å­˜åœ¨**
   ```bash
   # æŸ¥çœ‹å¯ç”¨æ¥å£
   ip link show
   # ä½¿ç”¨æ­£ç¡®çš„æ¥å£å
   sudo ./set_network_conditions.sh -i ä½ çš„æ¥å£å 10
   ```

3. **strongSwanæœªè¿è¡Œ**
   ```bash
   # å¯åŠ¨strongSwan
   sudo systemctl start strongswan
   # æ£€æŸ¥çŠ¶æ€
   sudo systemctl status strongswan
   ```

4. **è¿æ¥é…ç½®é—®é¢˜**
   ```bash
   # æ£€æŸ¥è¿æ¥é…ç½®
   swanctl --list-conns
   # ç¡®ä¿è¿æ¥åç§°æ­£ç¡®
   sudo ./burst_loss_test.sh -c ä½ çš„è¿æ¥å
   ```

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹å®æ—¶æ—¥å¿—**
   ```bash
   sudo journalctl -u strongswan -f
   ```

2. **æ£€æŸ¥ç½‘ç»œæ¡ä»¶**
   ```bash
   sudo ./set_network_conditions.sh -s
   ```

3. **ç›‘æ§é‡ä¼ æ´»åŠ¨**
   ```bash
   sudo ./retransmission_stats.sh -l
   ```

## ğŸ“‹ æµ‹è¯•å»ºè®®

### å®Œæ•´æ€§èƒ½è¯„ä¼°æµç¨‹

1. **åŸºçº¿æµ‹è¯•** (æ— ä¸¢åŒ…)
   ```bash
   sudo ./set_network_conditions.sh 0
   sudo ./retransmission_stats.sh -n 20
   ```

2. **ä½ä¸¢åŒ…ç‡æµ‹è¯•** (2-10%)
   ```bash
   for rate in 2 5 8 10; do
     sudo ./set_network_conditions.sh -b $rate
     sudo ./retransmission_stats.sh -n 15
     sleep 30
   done
   ```

3. **é«˜ä¸¢åŒ…ç‡æµ‹è¯•** (15-50%)
   ```bash
   sudo ./burst_loss_test.sh -n 30
   ```

4. **æ•°æ®åˆ†æ**
   - ä½¿ç”¨ç”Ÿæˆçš„CSVæ–‡ä»¶åˆ›å»ºå›¾è¡¨
   - å¯¹æ¯”ä¸åŒç®—æ³•çš„æ€§èƒ½å·®å¼‚
   - åˆ†æé‡ä¼ æ¨¡å¼å’Œæ•ˆç‡

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æµ‹è¯•ç¯å¢ƒ**: ç¡®ä¿æµ‹è¯•æœŸé—´ç½‘ç»œç¯å¢ƒç¨³å®š
2. **æ•°æ®é‡**: é«˜ä¸¢åŒ…ç‡ä¸‹æµ‹è¯•æ—¶é—´ä¼šæ˜¾è‘—å¢åŠ 
3. **èµ„æºå ç”¨**: å¤§é‡æµ‹è¯•å¯èƒ½äº§ç”Ÿå¤§é‡æ—¥å¿—æ•°æ®
4. **ç®—æ³•é€‰æ‹©**: ä¸åŒåé‡å­ç®—æ³•çš„åˆ†ç‰‡å¤§å°å·®å¼‚å¾ˆå¤§
5. **æ¸…ç†**: æµ‹è¯•å®Œæˆåè®°å¾—æ¸…ç†ç½‘ç»œæ¡ä»¶è®¾ç½®

## ğŸ¯ é¢„æœŸç»“æœ

- **è¿æ¥æˆåŠŸç‡**: éšä¸¢åŒ…ç‡å¢åŠ è€Œä¸‹é™
- **æ¡æ‰‹å®Œæˆæ—¶é—´**: éšä¸¢åŒ…ç‡å¢åŠ è€Œå¢é•¿ï¼Œåˆ†å¸ƒå˜å¾—æ›´åˆ†æ•£
- **é‡ä¼ æ¬¡æ•°**: ä¸ä¸¢åŒ…ç‡æ­£ç›¸å…³ï¼Œä½“ç°ç½‘ç»œæ¢å¤èƒ½åŠ›

è¿™äº›æ•°æ®å°†æ¸…æ™°å±•ç¤ºstrongSwanåœ¨æ¶åŠ£ç½‘ç»œæ¡ä»¶ä¸‹çš„è¡¨ç°ï¼Œç‰¹åˆ«æ˜¯åé‡å­å¯†ç å­¦åœºæ™¯ä¸­çš„å¤§åˆ†ç‰‡å¤„ç†èƒ½åŠ›ã€‚ 